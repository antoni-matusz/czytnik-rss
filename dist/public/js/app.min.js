!function(){window.APP={Models:{},Collections:{},Views:{},Routers:{},Regions:{appContent:$(".app-content")},ViewsInstances:{}},APP.showMainView=function(a){if(APP.ViewsInstances.mainView){var b=APP.ViewsInstances.mainView.childViews;b&&_.each(b,function(a){a.remove()}),APP.ViewsInstances.mainView.remove()}APP.ViewsInstances.mainView=a},APP.init=function(){APP.router=new APP.Routers.Router,Backbone.history.start({pushState:!0})}}(),function(){APP.Models.Feeds=Backbone.Model.extend({idAttribute:"_id",url:function(){return this.isNew()?"/feeds":"/feed/"+this.get("_id")}})}(),function(){APP.Collections.FeedsListCollection=Backbone.Collection.extend({model:APP.Models.Feeds,url:"/feeds"})}(),function(){APP.Views.AddNewFeed=Backbone.View.extend({tagName:"div",template:_.template($("#showAddNewFeedTemplate").html()),initialize:function(){this.render(),this.listenTo(this.model,"update",this.redirectToHome)},render:function(){var a=this.template(this.model.toJSON());this.$el.html(a),APP.Regions.appContent.html(this.el),this.stickit()},bindings:{"#title":"title","#description":"description","#date":"date"},events:{"submit form":"addNew","click .goHome":"redirectToHome"},addNew:function(a){a.preventDefault();var b=this.model.save({wait:!0});b&&this.redirectToHome()},redirectToHome:function(){APP.router.navigate("/",{trigger:!0})}})}(),function(){APP.Views.FeedDelete=Backbone.View.extend({tagName:"div",template:_.template($("#feedDeleteTemplate").html()),initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.redirectToHome)},render:function(){var a=this.template(this.model.toJSON());this.$el.html(a),APP.Regions.appContent.html(this.el)},events:{"click .goHome":"redirectToHome","click .okDelete":"okDelete"},redirectToHome:function(){APP.router.navigate("/",{trigger:!0})},okDelete:function(){var a=confirm("Czy na pewno chcesz usunąć?");a&&this.model.destroy({wait:!0})}})}(),function(){APP.Views.FeedDetails=Backbone.View.extend({tagName:"div",template:_.template($("#feedDetailsTemplate").html()),initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){var a=this.template(this.model.toJSON());this.$el.html(a),APP.Regions.appContent.html(this.el)},events:{"click .goHome":"redirectToHome","click .title":"showDetails"},redirectToHome:function(){APP.router.navigate("/",{trigger:!0})},showDetails:function(){APP.router.navigate("/feed/"+this.model.get("_id")+"/details",{trigger:!0})}})}(),function(){APP.Views.FeedShowDetails=Backbone.View.extend({tagName:"div",template:_.template($("#feedShowDetailsTemplate").html()),initialize:function(){this.listenTo(this.model,"change",this.render)},render:function(){var a=this.template(this.model.toJSON());this.$el.html(a),APP.Regions.appContent.html(this.el)},events:{"click .goHome":"redirectToHome","click .goFeed":"showFeed"},redirectToHome:function(){APP.router.navigate("/",{trigger:!0})},showFeed:function(){APP.router.navigate("/feed/"+this.model.get("_id"),{trigger:!0})}})}(),function(){APP.Views.FeedsListItemView=Backbone.View.extend({tagName:"li",template:_.template($("#feedsListItemTemplate").html()),render:function(){var a=this.template(this.model.toJSON());return this.$el.html(a),this},events:{"click .title":"redirectToDetails","click .deleteFeed":"deleteFeed","click .addFeed":"addFeed"},deleteFeed:function(){APP.router.navigate("/delete-feed/"+this.model.get("_id"),{trigger:!0})},redirectToDetails:function(){APP.router.navigate("/feed/"+this.model.get("_id"),{trigger:!0})},addFeed:function(){APP.router.navigate("new-feed",{trigger:!0})}})}(),function(){APP.Views.FeedsListView=Backbone.View.extend({tagName:"ul",className:"feeds-list",initialize:function(){this.listenTo(this.collection,"reset",this.render)},render:function(){this.collection.each(this.addOne,this),APP.Regions.appContent.append(this.el)},addOne:function(a){var b=new APP.Views.FeedsListItemView({model:a});this.$el.append(b.render().el)}})}(),function(){APP.Routers.Router=Backbone.Router.extend({routes:{"":"showFeedsList",feeds:"showFeedsList","feed/:id":"showFeedDetails","feed/:id/details":"showFeedDetailsDescription","new-feed":"showAddNewFeed","delete-feed/:id":"showDeleteFeed"},showFeedsList:function(){var a=new APP.Collections.FeedsListCollection,b=new APP.Views.FeedsListView({collection:a});APP.showMainView(b),a.fetch({reset:!0,data:{}})},showFeedDetails:function(a){var b=new APP.Models.Feeds({_id:a}),c=new APP.Views.FeedDetails({model:b});APP.showMainView(c),b.fetch()},showFeedDetailsDescription:function(a){var b=new APP.Models.Feeds({_id:a}),c=new APP.Views.FeedShowDetails({model:b});APP.showMainView(c),b.fetch()},showDeleteFeed:function(a){var b=new APP.Models.Feeds({_id:a}),c=new APP.Views.FeedDelete({model:b});APP.showMainView(c),b.fetch()},showAddNewFeed:function(){var a=new APP.Models.Feeds,b=new APP.Views.AddNewFeed({model:a});APP.showMainView(b)}})}(),function(){APP.init()}();